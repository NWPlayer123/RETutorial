## OS/FS and Security
If you have encrypted media, like a disc or cartridge, you don't want anyone being able to decrypt it besides you, so you just decrypt it before handing it to the program, except you don't want to pass them a handle to the raw data cause then they can decrypt anything they want, so you just have to handle everything and gate access to files so it stays secure and can't be abused. Program requests file.bin from FS which passes request to kernel, depends on request, have to pass a location to copy raw data to cause you can't just pass the entire cart or disc to program, wouldn't fit in memory.

Only really need several types of requests, OpenFile gets handle but only allows requests, not actual access, ReadFile which you pass location in memory to copy to and kernel decrypts to raw data and copies to location, needs to be fast so it's not a bottleneck, same with ReadFileWithPos, just different location in cart/disk from file start, filesystem modifications should be handled by kernel anyways, not safe to trust userspace or module, DeleteFile, OpenFile with create flag, CreateFolder, etc, kernel encrypts and writes data to NAND or w/e for the new folder or whatever, and since it handles finding and opening files/folders, it can handle all the different errors that can happen.

Of course, you can't trust the program to do much of anything so you have to deny permissions to anything it's not supposed to access, privileges, which e.g. Wii U/3DS handles by assigning titles (0005000010176900) to each "package", and it can only access its own assigned stuff, its part of the save directory (which you also need to handle in kernel, all file access, userspace FS just handles requests that it's safe to handle)
